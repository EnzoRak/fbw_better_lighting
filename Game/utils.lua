function p.project(lp, cam_pos, look, left, up)
    local aspect       = ga_get_sys_f("display.camera_params.a_ratio.value")
    local vfov         = ga_get_sys_f("display.camera_params.vfov")
    local fov_scale    = utils.get_fov_scale(vfov)
    local fov_aspect   = (0.5 / aspect) * fov_scale  
    local half_fov     = 0.5 * fov_scale             

    local rx = corner.x - cam_pos.x
    local ry = corner.y - cam_pos.y
    local rz = corner.z - cam_pos.z

    local depth = std.dot(std.vec(rx, ry, rz), look)
    if depth <= 0 then
        return nil, nil
    end

    local x_dot = std.dot(std.vec(rx, ry, rz), left)
    local y_dot = std.dot(std.vec(rx, ry, rz), up)
    local inv_depth = 1 / depth

    local x_proj = x_dot * inv_depth * fov_aspect
    local y_proj = y_dot * inv_depth * half_fov

    local screen_x = 0.5 - x_proj
    local screen_y = 0.5 + y_proj
    return screen_x, screen_y
end

function p.get_fov_scale(vfov) 
    if vfov < 10 then
        return 11.430052302761
    elseif vfov > 170 then
        return 0.57735026918963
    end

    return p.vfov_scale_lookup[math.floor(vfov)-9]
end

-- Generated through the above generate_fov_scale_lookup_table() function
-- This is a lookup table for the fov scale based on the vertical field of view
p.vfov_scale_lookup={11.430052302761,10.385397080138,9.5143644542226,8.77688735687,8.1443464279746,7.5957541127252,7.1153697223842,6.6911562383174,6.313751514675,5.9757643644331,5.6712818196177,5.3955171743191,5.1445540159703,4.9151570310712,4.7046301094785,4.5107085036621,4.3314758742842,4.1652997700904,4.0107809335358,3.8667130948987,3.7320508075689,3.6058835087609,3.4874144438409,3.3759434225912,3.2708526184841,3.1715948023632,3.0776835371753,2.9886849627429,2.9042108776758,2.8239128856008,2.7474774194546,2.6746214939268,2.6050890646938,2.5386478956643,2.4750868534163,2.4142135623731,2.3558523658238,2.2998425472363,2.2460367739042,2.194299731165,2.1445069205096,2.0965435990882,2.0503038415793,2.005689708259,1.9626105055052,1.9209821269712,1.8807264653463,1.8417708860335,1.8040477552714,1.7674940162429,1.7320508075689,1.6976631193261,1.6642794823505,1.6318516871288,1.6003345290411,1.5696855771175,1.5398649638146,1.5108351936149,1.4825609685127,1.4550090286724,1.4281480067421,1.4019482944763,1.3763819204712,1.3514224379458,1.3270448216204,1.3032253728412,1.2799416321931,1.257172298919,1.2348971565351,1.2130970040929,1.1917535925942,1.1708495661125,1.150368407221,1.1302943863618,1.1106125148292,1.0913085010693,1.0723687100247,1.053780125281,1.0355303137906,1.0176073929721,1.0,0.98269726311569,0.96568877480707,0.94896456671488,0.93251508613766,0.91633117401742,0.90040404429784,0.88472526455594,0.86928673781623,0.85408068546347,0.83909963117728,0.8243363858175,0.80978403319501,0.79543591666783,0.78128562650672,0.76732698797896,0.75355405010279,0.73996107502849,0.72654252800536,0.71329306789701,0.70020753820971,0.68728095860161,0.67450851684243,0.66188556119569,0.64940759319751,0.63707026080749,0.62486935190933,0.61280078813993,0.60086061902756,0.58904501642055,0.57735026918963,0.56577277818777,0.55430905145277,0.54295569963844,0.53170943166148,0.52056705055175,0.50952544949443,0.49858160805343,0.48773258856586,0.47697553269816,0.466307658155,0.45572625553258,0.44522868530854,0.43481237496093,0.4244748162096,0.4142135623731,0.40402622583516,0.39391047561494,0.38386403503542,0.3738846794848,0.3639702342662,0.3541185725307,0.34432761328967,0.33459531950207,0.32491969623291,0.31529878887898,0.30573068145866,0.29621349496208,0.28674538575881,0.27732454405984,0.26794919243112,0.25861758435589,0.24932800284318,0.24007875908012,0.23086819112556,0.22169466264294,0.21255656167002,0.2034522994237,0.19438030913772,0.18533904493153,0.17632698070847,0.16734260908142,0.15838444032454,0.14945100134913,0.14054083470239,0.1316524975874,0.1227845609029,0.11393560830165,0.10510423526568,0.096289048197539,0.087488663525924,}
